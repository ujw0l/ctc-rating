(()=>{"use strict";class t{constructor(t){null!=t&&this.createOverlay(t)}createOverlay(t){let e=window.innerWidth+1,r=window.innerHeight+1,i=null!=t.containerHt?t.containerHt:500,a=null!=t.containerWd?t.containerWd:650,n=this.getOptimizedElSize(window.innerWidth,window.innerHeight,a,i),o=document.createElement("style");o.id="ctc-scroll-css",o.innerHTML="::-webkit-scrollbar-track {background: rgba(255, 255, 255, 1);} ::-moz-scrollbar-track { background: rgba(255, 255, 255, 1);} #gal-sidebar::-webkit-scrollbar {display: none;} #gal-sidebar::-moz-scrollbar {display: none;}",document.querySelector("head").appendChild(o),document.body.style.overflow="hidden";let l=document.createElement("div");l.id="js-modal-overlay",l.style=`position:fixed;height:${r}px;width:${e}px;background-color:rgba(0,0,0,.6);z-index:100000;top:0%;left:0%;right:0%;bottom:0%;`;let d=document.createElement("div");d.id="js-modal-el-container",d.style=`overflow:auto;border:1px solid rgba(0,0,0,1);left:${(e-5-n.width)/2}px;top:${(r-n.height)/2}px;width:${n.width}px;height:${n.height}px;position:absolute;float:left;background-color:rgba(255,255,255,1);`,l.appendChild(d);let s=document.createElement("span");s.id="overlay-close-btn",s.title="Close",s.innerHTML="&#10539;",s.style=`line-height:1.5;text-align:center;position:absolute;width:30px;height:30px;cursor:pointer;top:${(r-n.height)/2-25}px;left:${(e-n.width)/2+n.width-8}px;font-size:20px;color:rgba(255,255,255,1);text-shadow:-1px -1px 1px rgba(0,0,0,1);z-index:100000;`,l.appendChild(s),s.addEventListener("click",(()=>{document.body.removeChild(l),document.querySelector("head").removeChild(o)})),null!=t.elContent?(d.innerHTML=t.elContent,document.body.insertBefore(l,document.body.firstChild)):null!=t.imgGallery?this.loadGallery(l,s,d,t,[n.height,n.width]):null!=t.iframeUrl?(d.innerHTML=`<iframe height="${n.height}" width="${n.width}" frameBorder= "0"   src="${t.iframeUrl}" ></iframe>`,document.body.insertBefore(l,document.body.firstChild)):(l.appendChild(d),this.ajaxContent(d,t,[n.height,n.width]),document.body.insertBefore(l,document.body.firstChild)),window.addEventListener("resize",(()=>this.adjustOverlay(l,d,s,[i,a])))}adjustOverlay(t,e,r,i){let a=window.innerWidth+1,n=window.innerHeight+1,o=(e.querySelector("#content-loading"),t.querySelector("#img-loading")),l=this.getOptimizedElSize(window.innerWidth,window.innerHeight,i[1],i[0]);t.style.width=a+"px",t.style.height=n+"px",r.style.left=(a-l.width)/2+l.width-8+"px",r.style.top=(n-l.height)/2-25+"px";let d=e.querySelector("img");if(null!=d){let t=parseInt(d.getAttribute("data-img-count")),r=e.querySelector("#img-title"),i=new Image;i.src=d.src;let a=this.getOptimizedElSize(l.width-60,l.height-60,i.width,i.height,1),n=1<t?(l.width-a.width)/2-26:(l.width-a.width)/2;d.style.height=a.height+"px",d.style.width=a.width+"px",d.style.marginLeft=n+"px",d.style.marginTop=(l.height-a.height)/2+"px",r.style.marginTop=l.height-25+"px",r.style.width=l.width+"px",2<=t&&(e.querySelector("#next-btn").style.marginTop=(l.height-25)/2+"px",e.querySelector("#prev-btn").style.marginTop=(l.height-25)/2+"px")}e.style.left=(a-5-l.width)/2+"px",e.style.top=(n-l.height)/2+"px",e.style.height=l.height+"px",e.style.width=l.width+"px",null!=o&&(o.style.marginTop=(window.innerHeight-46)/2+"px",o.style.marginLeft=(window.innerWidth-46)/2+"px")}ajaxContent(t,e,r){let i=null!=e.ajaxMethod?e.ajaxMethod.toUpperCase():"GET",a=null!=e.ajaxData?e.ajaxData:"",n=t.querySelector("#content-loading");if(null==n){n=document.createElement("div"),n.id="content-loading",n.style=`margin-left:${(r[1]-46)/2}px;margin-top:${(r[0]-46)/2}px;height:40px;width:40px;border-radius:50%;border-color:rgba(0,0,0,1);border-style: solid; border-width: 3px;z-index:1100; `,n.setAttribute("data-wait","left"),t.appendChild(n);var o=setInterval((()=>{switch(n.getAttribute("data-wait")){case"left":n.setAttribute("data-wait","top"),n.style.borderColor="rgba(0,0,0,0.5)",n.style.borderTop="3px solid  rgba(0,0,0,1)";break;case"top":n.setAttribute("data-wait","right"),n.style.borderColor="rgba(0,0,0,0.5)",n.style.borderRight="3px solid  rgba(0,0,0,1)";break;case"right":n.setAttribute("data-wait","bottom"),n.style.borderColor="rgba(0,0,0,0.5)",n.style.borderBottom="3px solid  rgba(0,0,0,1)";break;case"bottom":n.setAttribute("data-wait","left"),n.style.borderColor="rgba(0,0,0,0.5)",n.style.borderLeft="3px solid  rgba(0,0,0,1)"}}),400)}var l=new XMLHttpRequest;l.open(i,e.ajaxUrl,!0),l.responseType="text",l.setRequestHeader("Content-Type","application/x-www-form-urlencoded;"),l.addEventListener("load",(e=>{e.target.status>=200&&e.target.status<400?(clearInterval(o),t.innerHTML=e.target.response):console.log(e.target.statusText)})),l.send(a)}loadGallery(t,e,r,i,a){Array.from(document.querySelectorAll(i.imgGallery)).forEach(((i,a)=>{let n=Array.from(i.querySelectorAll("img"));n.forEach(((i,a)=>{i.addEventListener("click",(o=>{null==document.querySelector("#js-modal-overlay")&&document.body.insertBefore(t,document.body.firstChild),this.loadImg(t,e,r,i,a,n,[r.offsetHeight,r.offsetWidth])}))}))}))}loadImg(t,e,r,i,a,n,o){let l=n.length-1>a?a+1:0,d=0<a?a-1:n.length-1,s=1<n.length?`<font style="font-size:11px;" > (${a+1}/${n.length})</font>`:"",c=0<i.title.length?i.title+s:""+s;e.style.display="none",r.style.display="none";let u=new Image;if(u.setAttribute("data-img-count",n.length),u.src=i.src,null==r.querySelector("#img-title")){let t=document.createElement("span");t.id="img-title",t.style=`overflow:auto;font-size:15px;color:rgba(0,0,0,1);line-height:1.5;font-family:'Courier New', Courier, monospace;text-align:center;position:absolute;left:0px;height:25px;width:${.97*o[1]}px;margin-top:${.98*o[0]-25}px;z-index:100;`,t.innerHTML=c,r.appendChild(t)}else r.querySelector("#img-title").innerHTML=c;if(2<=n.length){if(null==r.querySelector("#prev-btn")){let i=document.createElement("span");i.id="prev-btn",i.title="Previous Image",i.innerHTML="<",i.setAttribute("data-img-num",d),i.style=`color:rgba(0,0,0,1);border:1px solid rgba(0,0,0,1);font-size:20px;cursor:pointer;font-family:'Courier New', Courier, monospace;text-align:center;line-height: 1.1;margin-left:2px;margin-top:${(o[0]-25)/2}px;width:20px;height:20px;float:left;z-index:100;`,i.addEventListener("mouseover",(t=>t.target.style.boxShadow="1px 1px 5px 1px rgba(0,0,0,1)")),i.addEventListener("mouseleave",(t=>t.target.style.boxShadow="")),i.addEventListener("click",(i=>this.loadImg(t,e,r,n[parseInt(i.target.getAttribute("data-img-num"))],parseInt(i.target.getAttribute("data-img-num")),n,[r.offsetHeight,r.offsetWidth]))),r.appendChild(i)}else r.querySelector("#prev-btn").setAttribute("data-img-num",d);if(null==r.querySelector("#next-btn")){let i=document.createElement("span");i.id="next-btn",i.innerHTML=">",i.title="Next Image",i.style=`color:rgba(0,0,0,1);border:1px solid rgba(0,0,0,1);font-size:20px;cursor:pointer;font-family:'Courier New', Courier, monospace;text-align:center;line-height: 1.1;margin-right:2px;margin-top:${(o[0]-25)/2}px;width:20px;height:20px;float:right;z-index:100;`,i.setAttribute("data-img-num",l),i.addEventListener("mouseover",(t=>t.target.style.boxShadow="1px 1px 5px 1px rgba(0,0,0,1)")),i.addEventListener("mouseleave",(t=>t.target.style.boxShadow="")),i.addEventListener("click",(i=>this.loadImg(t,e,r,n[parseInt(i.target.getAttribute("data-img-num"))],parseInt(i.target.getAttribute("data-img-num")),n,[r.offsetHeight,r.offsetWidth]))),r.appendChild(i)}else r.querySelector("#next-btn").setAttribute("data-img-num",l)}null!=r.querySelector("img")&&r.removeChild(r.querySelector("img"));let h=r.querySelector("#content-loading");if(null==h){h=document.createElement("div"),h.id="img-loading",h.style=`display:inline-block;float:left;position:relative;margin-left:${(window.innerWidth-46)/2}px;margin-top:${(window.innerHeight-46)/2}px;height:40px;width:40px;border-radius:50%;border-color:rgba(255,255,255,1);border-style: solid; border-width: 3px;z-index:1100; `,h.setAttribute("data-wait","left"),t.appendChild(h);var p=setInterval((()=>{switch(h.getAttribute("data-wait")){case"left":h.setAttribute("data-wait","top"),h.style.borderColor="rgba(255,255,255,1)",h.style.borderTop="3px solid  rgba(0,0,0,1)";break;case"top":h.setAttribute("data-wait","right"),h.style.borderColor="rgba(255,255,255,1)",h.style.borderRight="3px solid  rgba(0,0,0,1)";break;case"right":h.setAttribute("data-wait","bottom"),h.style.borderColor="rgba(255,255,255,1)",h.style.borderBottom="3px solid  rgba(0,0,0,1)";break;case"bottom":h.setAttribute("data-wait","left"),h.style.borderColor="rgba(255,255,255,1)",h.style.borderLeft="3px solid  rgba(0,0,0,1)"}}),400)}u.addEventListener("load",(i=>{t.removeChild(h),clearInterval(p),e.style.display="",r.style.display="";let a=this.getOptimizedElSize(o[1]-80,o[0]-60,i.target.width,i.target.height,.995),l=1<n.length?(o[1]-a.width)/2-26:(o[1]-a.width)/2;i.target.style=`position:relative;border:1px solid rgba(0,0,0,1);float:left;height:${a.height}px;width:${a.width}px;margin-left:${l}px;margin-top:${(o[0]-a.height)/2}px;`,r.appendChild(i.target)}))}getOptimizedElSize(t,e,r,i,a){let n=0,o=0,l=0,d=0,s=null!=a?a:.9,c=1-s;if(r>=t&&i>=e)r>=i?r>i?(o=r/t,d=r/o-c*t,l=i*(d/r),l>=s*e&&(n=e/i,l=i*n-c*e,d=r*(l/i))):t>e?(l=s*e,d=l):e>t?(d=s*t,l=d):(n=e/i,l=i*n-c*e,d=r*(l/i)):(n=i/e,l=i/n-c*e,d=r*(l/i));else if(r>=t&&i<e)o=t/r,d=r*o-c*t,l=i*(d/r);else if(i>=e&&r<t)n=e/i,l=i*n-c*e,d=r*(l/i),l=i*(d/r);else{let a=s*t,o=s*e;r>=a&&i>=o?(d=a*(a/r),l=e*n):r>=a&&i<o?(d=r*(a/r),l=i*(d/r)):i>=o&&r<a?(l=i*(o/i),d=r*(l/i)):(d=r,l=i),l=i*(d/r)}return d>s*t&&(d=s*t,l=i*(d/r)),{width:d,height:l}}}window.addEventListener("DOMContentLoaded",(()=>{const e=new t,r=(t,e)=>{let r,a,n,o;switch(e){case"thumbsUp":r=document.querySelector("#ctcThumbUpCount-"+t),n=parseInt(r.getAttribute("data-type-thumupcount"))+1,r.innerHTML=i(n),r.setAttribute("data-type-thumupcount",n);break;case"thumbsDown":a=document.querySelector("#ctcThumbDownCount-"+t),o=parseInt(a.getAttribute("data-type-thumdowncount"))+1,a.innerHTML=i(o),a.setAttribute("data-type-thumdowncount",o);break;case"thumbsUpReversed":r=document.querySelector("#ctcThumbUpCount-"+t),a=document.querySelector("#ctcThumbDownCount-"+t),n=parseInt(r.getAttribute("data-type-thumupcount"))-1,o=parseInt(a.getAttribute("data-type-thumdowncount"))+1,r.innerHTML=i(n),r.setAttribute("data-type-thumupcount",n),a.innerHTML=i(o),a.setAttribute("data-type-thumdowncount",o);break;case"thumbsDownReversed":r=document.querySelector("#ctcThumbUpCount-"+t),a=document.querySelector("#ctcThumbDownCount-"+t),n=parseInt(r.getAttribute("data-type-thumupcount"))+1,o=parseInt(a.getAttribute("data-type-thumdowncount"))-1,r.innerHTML=i(n),r.setAttribute("data-type-thumupcount",n),a.innerHTML=i(o),a.setAttribute("data-type-thumdowncount",o);break;case"unThumbsUp":r=document.querySelector("#ctcThumbUpCount-"+t),n=parseInt(r.getAttribute("data-type-thumupcount"))-1,r.innerHTML=i(n),r.setAttribute("data-type-thumupcount",n);break;case"unThumbsDown":a=document.querySelector("#ctcThumbDownCount-"+t),o=parseInt(a.getAttribute("data-type-thumdowncount"))-1,a.innerHTML=i(o),a.setAttribute("data-type-thumdowncount",o)}},i=t=>{let e=[],r="",i="";e=(t+="").split("."),r=e[0],i=e.length>1?"."+e[1]:"";for(var a=/(\d+)(\d{3})/;a.test(r);)r=r.replace(a,"$1,$2");return r+i};Array.from(document.querySelectorAll([".ctcThumbUp",".ctcThumbDown",".ctcUserThumbUp",".ctcUserThumbDown"])).map((t=>t.addEventListener("click",(t=>(t=>{let e=t.getAttribute("data-type-id"),i="action=ctcUserRating&rating_data="+JSON.stringify({postId:e,ratingType:t.getAttribute("data-type-rating")});var a=new XMLHttpRequest;a.open("POST",ctcRating.ctcRatingAjaxUrl,!0),a.responseType="text",a.setRequestHeader("Content-Type","application/x-www-form-urlencoded;"),a.addEventListener("load",(i=>{if(!(i.target.status>=200&&i.target.status<400))return!1;"notLoggedIn"==i.target.response?alert(ctcRating.notLoggedIn):((t,e,i)=>{let a,n=i.getAttribute("data-type-scenario");switch(t){case"thumbsUp":i.title=ctcRating.alreadyThumbedUp,i.classList.remove("ctcThumbDown"),i.classList.add("ctcUserThumbUp"),r(e,"thumbsUp");break;case"thumbsDown":i.title=ctcRating.alreadyThumbedDown,i.classList.remove("ctcThumbUp"),i.classList.add("ctcUserThumbDown"),i.style.fontSize="25px",r(e,"thumbsDown");break;case"thumbsUpReversed":i.title=ctcRating.alreadyThumbedDown,i.classList.add("ctcUserThumbDown"),i.style.fontSize="25px",a=document.querySelector("#ctcThumbUp-"+e),a.title=ctcRating.thumbUp,a.classList.remove("ctcUserThumbUp"),a.classList.add("ctcThumbUp"),a.style.fontSize="20px",r(e,"thumbsUpReversed");break;case"thumbsDownReversed":i.title=ctcRating.alreadyThumbedUp,i.classList.remove("ctcThumbUp"),i.classList.add("ctcUserThumbUp"),i.style.fontSize="25px",a=document.querySelector("#ctcThumbDown-"+e),a.title=ctcRating.thumbDown,a.classList.remove("ctcUserThumbDown"),a.classList.add("ctcThumbDown"),a.style.fontSize="20px",r(e,"thumbsDownReversed",n);break;case"unThumbsUp":i.title=ctcRating.thumbUp,i.classList.remove("ctcUserThumbUp"),i.classList.add("ctcThumbUp"),i.style.fontSize="20px",r(e,"unThumbsUp");break;case"unThumbsDown":i.title=ctcRating.thumbDown,i.classList.remove("ctcUserThumbDown"),i.classList.add("ctcThumbDown"),i.style.fontSize="20px",r(e,"unThumbsDown")}})(i.target.response,e,t)})),a.send(i)})(t.target))))),Array.from(document.querySelectorAll(".ctcThumbsUpStat,.ctcThumbsDownStat")).map((t=>t.addEventListener("click",(t=>{var r;"0"!=("thumb-up-count"==t.target.getAttribute("data-get")?t.target.getAttribute("data-type-thumupcount"):t.target.getAttribute("data-type-thumdowncount"))&&(r=t.target,e.createOverlay({ajaxUrl:ctcRating.ctcRatingAjaxUrl,ajaxData:"action=ctcGetUsers&post_id="+r.getAttribute("data-post-id")+"&user_to_get="+r.getAttribute("data-get"),ajaxMethod:"POST",containerHt:350,containerWd:200}))}))))}))})();